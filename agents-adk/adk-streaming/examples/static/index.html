<!doctype html>
<html>
  <body>
    <h1>ADK WS demo</h1>
    <textarea id="log" cols="120" rows="20"></textarea><br/>
    <input id="msg" placeholder="type text and press enter"/>
    <script>
      const log = document.getElementById('log');
      const input = document.getElementById('msg');
      const ws = new WebSocket((location.protocol === 'https:' ? 'wss' : 'ws') + '://' + location.host + '/ws');
      ws.onmessage = (ev) => { const {mime_type,data} = JSON.parse(ev.data); if(mime_type==='text/plain'){ log.value += data; } };
      input.addEventListener('keydown', (e) => { if(e.key==='Enter'){ ws.send(JSON.stringify({mime_type:'text/plain', data: input.value})); input.value=''; }});
    </script>
  </body>
</html>